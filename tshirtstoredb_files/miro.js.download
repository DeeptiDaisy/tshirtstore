var miro=(()=>{var xe=Object.defineProperty;var dt=t=>xe(t,"__esModule",{value:!0}),n=(t,e)=>xe(t,"name",{value:e,configurable:!0});var ct=(t,e)=>{dt(t);for(var r in e)xe(t,r,{get:e[r],enumerable:!0})};var Mt={};ct(Mt,{board:()=>mt,clientVersion:()=>at});var G;(function(r){r.Success="S",r.Fail="F"})(G||(G={}));function Z(){return Math.random().toString(36).slice(-10)}n(Z,"generateId");function lt(t){return t instanceof ArrayBuffer||!1}n(lt,"isTransferableObject");var yt=n((t,e)=>Object.prototype.hasOwnProperty.call(t,e),"isPropertyOf");async function Ce(t){let e=[];if(t instanceof Blob)return[await t.arrayBuffer()];if(lt(t))return[t];if(typeof t!="object")return[];for(let r in t)if(yt(t,r)){let s=t[r];if(typeof s=="object"&&s!==null){let i=await Ce(s);e.push(...i)}}return e}n(Ce,"getTransferable");var Fe="sdkv2-plugin-message";function ut(t){return t.data?.commandId===Fe}n(ut,"isPluginMessageEvent");function ht(t){return t!==null&&"window"in t}n(ht,"isWindow");var Q=class{constructor(e){this.destroyed=!1;this.destroy=n(()=>{this.clients.forEach(e=>{e.waiting.clear()}),this.clients.clear(),this.hostWindow.removeEventListener("message",this.handlePostMessage),this.destroyed=!0},"destroy");this.createBus=n((e,r)=>{if(this.destroyed)throw new Error("SdkCommunicationBus: createBus is called on a destroyed instance");this.clients.set(e.container,{handler:r,target:e,waiting:new Map});let s=this.dispatch,{destroyBus:i}=this;return{target:e,dispatch({payload:a,msgId:c,transfer:w}){return s(e.container,a,c,w)},destroy(){return i(e.container)}}},"createBus");this.destroyBus=n(e=>{let r=this.clients.get(e);r&&(r.waiting.clear(),this.clients.delete(e))},"destroyBus");this.hostWindow=e,this.clients=new Map,this.handlePostMessage=this.handlePostMessage.bind(this),this.dispatch=this.dispatch.bind(this),this.destroyBus=this.destroyBus.bind(this),this.hostWindow.addEventListener("message",this.handlePostMessage)}handlePostMessage(e){if(!ut(e)||!ht(e.source))return;let r=this.clients.get(e.source);if(!r||r.target.origin!=="*"&&e.origin!==r.target.origin)return;let{data:s}=e,i=r.waiting.get(s.msgId);if(i)r.waiting.delete(s.msgId),i.resolve(s.payload);else{let a=n(c=>{c&&this.dispatch(r.target.container,c,s.msgId)},"after");r.handler(s.payload).then(a).catch(a)}}dispatch(e,r,s,i=[]){return new Promise((a,c)=>Ce(r).then(w=>{let N=!s,T=this.clients.get(e);if(!T)return;let K;N?(K=Z(),T.waiting.set(K,{resolve:a,reject:c})):K=s;let pt={commandId:Fe,payload:r,msgId:K},y=[...i,...w];T.target.container.postMessage(pt,T.target.origin,y),!N&&s&&(T.waiting.delete(s),a(null))}).catch(c))}};n(Q,"SdkCommunicationBus");var U=class{constructor({clientWindow:e=window}){let r=new Q(e);this.waitingResponse=new Map,this.handlers=new Map,this.responseHandler=this.responseHandler.bind(this),this.handle=this.handle.bind(this),this.busDispatcher=r.createBus({container:e.parent,origin:"*"},this.handle)}async push(e,r,s=[]){let i=Z(),c=[{name:e,payload:r,id:i}];return new Promise((w,N)=>{this.waitingResponse.set(i,{resolve:w,reject:N});let T={payload:c,transfer:s};this.busDispatcher.dispatch(T).then(this.responseHandler)})}responseHandler(e){let r=e;for(let s=0;s<r.length;s++){let i=r[s];if(!i)continue;let a=this.waitingResponse.get(i.id);a&&(i.status===G.Success?a.resolve(i.payload):i.status===G.Fail&&a.reject(new Error(String(i.payload))),this.waitingResponse.delete(i.id))}return Promise.resolve([])}handle(e){let r=e,s=[];for(let i=0;i<r.length;i++){let a=r[i];if(a.status){this.responseHandler([a]);continue}let c=this.handlers.get(a.id);c&&c.forEach(w=>{s.push(w(a))})}return Promise.all(s)}subscribe(e,r){let s=this.handlers.get(e)||[];this.handlers.set(e,[...s,r])}unsubscribe(e,r){r||this.handlers.delete(e);let s=(this.handlers.get(e)||[]).filter(i=>i!==r);this.handlers.set(e,s)}};n(U,"IframeCommander");var H=class{constructor(e,r){this.realCommander=e;this.prefix=r}push(e,r){let s=`${this.prefix.toUpperCase()}_${e}`;return this.realCommander.push(s,r)}subscribe(e,r){let s=`${this.prefix.toLowerCase()}:${e}`;this.realCommander.subscribe(s,r)}unsubscribe(e,r){let s=`${this.prefix.toLowerCase()}:${e}`;this.realCommander.unsubscribe(s,r)}};n(H,"CommanderProxy");function Ne(t){return Object.keys(t)}n(Ne,"keys");function _e(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)&&!(t instanceof Blob)}n(_e,"isObject");function p(t,...e){if(!e.length)return t;let r=e.shift();return _e(t)&&_e(r)&&Object.keys(r).forEach(s=>{_e(r[s])?(t[s]||Object.assign(t,{[s]:{}}),p(t[s],r[s])):Object.assign(t,{[s]:r[s]})}),p(t,...e)}n(p,"mergeDeep");async function V(t,e){return p(e,t),e}n(V,"mergeResponse");function q(t){let e={};return Object.keys(t).forEach(r=>{let s=t[r];typeof s!="function"&&(e[r]=s)}),e}n(q,"asProps");var Ge=n(async t=>new Promise((e,r)=>{let s=new FileReader;s.onload=()=>{e(s.result?.toString()??"")},s.onerror=()=>{r(s.error)},s.onabort=()=>{r(new Error("Aborted"))},s.readAsDataURL(t)}),"blobToDataUrl");var gt=n(()=>{throw new Error("board not initialized")},"boardNotInitialised"),Ue,l=n(()=>Ue??gt(),"board"),ft=n(()=>{throw new Error("commander not initialized")},"commanderNotInitialised"),He,h=n(()=>He??ft(),"commander"),Ve=n(t=>{Ue=t.board,He=t.commander},"register");async function x(t,e){return e===void 0?h().push(t):h().push(t,e)}n(x,"runCommand");var u=class{async sync(){return l().sync(this)}async getMetadata(e){return l().getMetadata(this,e)}async setMetadata(e,r){return l().setMetadata(this,e,r)}async goToLink(){return l().goToLink(this)}async bringToFront(){return l().bringToFront(this)}async sendToBack(){return l().sendToBack(this)}async bringInFrontOf(e){return l().bringInFrontOf(this,e)}async sendBehindOf(e){return l().sendBehindOf(this,e)}async getLayerIndex(){return l().getLayerIndex(this)}async getConnectors(){let e=this.connectorIds;return!e||e.length===0?[]:l().get({id:e})}};n(u,"BaseItem");var C=class extends u{constructor(e){super();this.type="text";this.content="";this.style={fillColor:"transparent",fillOpacity:1,fontFamily:"arial",fontSize:14,textAlign:"left",color:"#1a1a1a"};p(this,e)}};n(C,"Text");var qe;(function(m){m.Rectangle="rectangle",m.Circle="circle",m.Triangle="triangle",m.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",m.RoundRectangle="round_rectangle",m.Rhombus="rhombus",m.Parallelogram="parallelogram",m.Star="star",m.RightArrow="right_arrow",m.LeftArrow="left_arrow",m.Pentagon="pentagon",m.Hexagon="hexagon",m.Octagon="octagon",m.Trapezoid="trapezoid",m.FlowChartPredefinedProcess="flow_chart_predefined_process",m.LeftRightArrow="left_right_arrow",m.Cloud="cloud",m.LeftBrace="left_brace",m.RightBrace="right_brace",m.Cross="cross",m.Can="can"})(qe||(qe={}));var ee;(function(d){d.Gray="gray",d.LightYellow="light_yellow",d.Yellow="yellow",d.Orange="orange",d.LightGreen="light_green",d.Green="green",d.DarkGreen="dark_green",d.Cyan="cyan",d.LightPink="light_pink",d.Pink="pink",d.Violet="violet",d.Red="red",d.LightBlue="light_blue",d.Blue="blue",d.DarkBlue="dark_blue",d.Black="black"})(ee||(ee={}));var te;(function(y){y.Red="red",y.Magenta="magenta",y.Violet="violet",y.LightGreen="light_green",y.Green="green",y.DarkGreen="dark_green",y.Cyan="cyan",y.Blue="blue",y.DarkBlue="dark_blue",y.Yellow="yellow",y.Gray="gray",y.Black="black"})(te||(te={}));var _=class extends u{constructor(e){super();this.type="sticky_note";this.shape="square";this.content="";this.style={fillColor:ee.LightYellow,textAlign:"center",textAlignVertical:"middle"};this.tagIds=[];p(this,e)}};n(_,"StickyNote");var I=class extends u{constructor(e){super();this.type="shape";this.content="";this.shape="rectangle";this.style={fillColor:"transparent",fontFamily:"arial",fontSize:14,textAlign:"center",textAlignVertical:"middle",borderStyle:"normal",borderOpacity:1,borderColor:"#1a1a1a",borderWidth:2,fillOpacity:1,color:"#1a1a1a"};p(this,e)}};n(I,"Shape");var P=class extends u{constructor(e){super();this.type="shape";this.content="";this.shape="rectangle";this.style={fillColor:"transparent",fontFamily:"arial",fontSize:14,textAlign:"center",textAlignVertical:"middle",borderStyle:"normal",borderOpacity:1,borderColor:"#1a1a1a",borderWidth:2,fillOpacity:1,color:"#1a1a1a"};p(this,e)}async sync(){return l().experimental.sync(this)}};n(P,"ShapeExperimental");var D=class extends u{constructor(e){super();this.type="image";this.title="";this.alt="";p(this,e)}async getFile(e="original"){let r={id:this.id,format:e},s=await x("IMAGE_GET_BLOB",r);return new File([s],this.title,{lastModified:+this.modifiedAt})}async getDataUrl(e){let r=await this.getFile(e);return await Ge(r)}};n(D,"Image");var A=class extends u{constructor(e){super();this.type="card";this.title="";this.description="";this.style={};this.dueDate=void 0;this.assignee=void 0;this.taskStatus="none";this.tagIds=[];this.fields=[];p(this,e)}};n(A,"Card");var R=class extends u{constructor(e){super();this.type="app_card";this.owned=!1;this.title="";this.description="";this.style={};this.tagIds=[];this.status="disconnected";this.fields=[];p(this,e)}};n(R,"AppCard");var M=class extends u{constructor(e){super();this.type="frame";this.title="";this.childrenIds=[];this.style={fillColor:"transparent"};p(this,e)}async add(e){this.childrenIds.push(e.id),await this.sync();let[r]=await l().experimental.get({id:e.id});return p(e,r),e}async remove(e){let r=e.id;if(!r)throw new Error("trying to remove a non-existent item from a frame");let s=this.childrenIds.findIndex(a=>a===r);if(s===-1)throw new Error(`Can't remove item ${r} from frame ${this.id}. The item is not a current child`);this.childrenIds.splice(s,1),await this.sync();let[i]=await l().experimental.get({id:e.id});p(e,i)}async getChildren(){let e=this.childrenIds;return e.length===0?[]:l().get({id:e})}};n(M,"Frame");var W=class extends u{constructor(e){super();this.type="unsupported";p(this,e)}};n(W,"Unsupported");var O=class extends u{constructor(e){super();this.type="preview";p(this,e)}};n(O,"Preview");var L=class extends u{constructor(e){super();this.type="embed";this.previewUrl="";this.mode="inline";p(this,e)}};n(L,"Embed");var S=class{constructor(e){this.type="connector";this.shape="curved";this.start=void 0;this.end=void 0;this.style={};this.captions=[];p(this,e)}async sync(){return l().sync(this)}async getMetadata(e){return l().getMetadata(this,e)}async setMetadata(e,r){return l().setMetadata(this,e,r)}};n(S,"Connector");var vt=n(t=>({type:"text",content:t.content,style:{}}),"viewTransformText"),wt=n(t=>({type:"shape",shape:t.shape,content:t.content,style:{color:t.style.color,fillOpacity:t.style.fillOpacity,borderStyle:t.style.borderStyle}}),"viewTransformShape"),bt=n(t=>t.type==="shape"?wt(t):t.type==="text"?vt(t):{},"transformNodeView"),k=class extends u{constructor(e){super();this.type="mindmap_node";p(this,e)}async sync(){return this.nodeView=bt(this.nodeView),l().experimental.sync(this)}async add(e){this.childrenIds.push(e.id),await this.sync();let[r]=await l().experimental.get({id:e.id});return p(e,r),e}async getChildren(){let e=this.childrenIds;return e.length===0?[]:l().experimental.get({id:e})}};n(k,"MindmapNode");var re=class{constructor(e){this.type="mindmap_node";p(this,e)}};n(re,"MindmapNodeCreate");var B=class{constructor(e){this.type="tag";this.title="";this.color=te.Red;p(this,e)}async sync(){return l().sync(this)}};n(B,"TagEntity");function f(t){switch(t.type){case"text":return new C(t);case"sticky_note":return new _(t);case"shape":return new I(t);case"image":return new D(t);case"frame":return new M(t);case"preview":return new O(t);case"card":return new A(t);case"app_card":return new R(t);case"embed":return new L(t);case"connector":return new S(t);case"tag":return new B(t);case"document":case"mockup":case"curve":case"webscreen":case"usm":case"mindmap":case"kanban":case"table":case"svg":case"emoji":case"mindmap_node":default:return new W(t)}}n(f,"convertToSdkFormat");function Y(t){switch(t.type){case"shape":return new P(t);case"mindmap_node":return new k(t);default:return f(t)}}n(Y,"convertToSdkFormatExperimental");var Et=["drag","drop","dragend","dragstart"],Pt={"pointer-events":"none","user-select":"none","-webkit-user-select":"none","-webkit-touch-callout":"none"},ne=class{constructor(){this.listeners=[];this.originalBodyStyle={};this.dragStartPosition={x:-1/0,y:-1/0}}setDragStartPosition(e,r){this.dragStartPosition={x:e,y:r}}shouldDispatchDrag(e,r){return Math.abs(e-this.dragStartPosition.x)>ne.DRAG_THRESHOLD||Math.abs(r-this.dragStartPosition.y)>ne.DRAG_THRESHOLD}resetDragging(){throw new Error("Not implemented")}addListener(e,r,s){this.listeners.push({type:e,selector:r,handler:s})}removeListener(e,r,s){this.listeners=this.listeners.filter(i=>i.type!==e||r!=null&&i.selector!==r||s!=null&&i.handler!==s)}isDraggableElement(e){return!(e instanceof HTMLElement)&&!(e instanceof SVGElement)?!1:this.listeners.some(({selector:r})=>!!e.closest(r))}disableClickEvents(){Object.entries(Pt).forEach(([e,r])=>{this.originalBodyStyle[e]=document.body.style.getPropertyValue(e),document.body.style.setProperty(e,r)})}restoreClickEvents(){Object.entries(this.originalBodyStyle).forEach(([e,r])=>{document.body.style.setProperty(e,r)}),this.originalBodyStyle={}}dragEnd(e){this.dispatch("dragend",{target:e,clientX:NaN,clientY:NaN,screenX:NaN,screenY:NaN})}dispatch(e,r){this.listeners.forEach(({selector:s,handler:i,type:a})=>{if(e!==a)return;let c=r.target.closest(s);if(!c)return;let w=new CustomEvent(e,{detail:{...r,target:c,type:e}});i(w)})}},$=ne;n($,"BaseDragSensor"),$.DRAG_THRESHOLD=8;var Ie=class extends ${constructor(){super();this.isDragging=!1;this.onMouseDown=n(e=>{let r=e.target;!this.isDraggableElement(r)||(r.setAttribute("draggable","false"),this.target=r,this.setDragStartPosition(e.clientX,e.clientY),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove,{passive:!0}))},"onMouseDown");this.onMouseMove=n(e=>{if(!this.target)return;let{clientX:r,clientY:s,screenX:i,screenY:a}=e;if(!this.isDragging&&!this.shouldDispatchDrag(r,s))return;let c=this.isDragging?"drag":"dragstart";this.isDragging||this.disableClickEvents(),this.isDragging=!0,this.dispatch(c,{target:this.target,clientX:r,clientY:s,screenX:i,screenY:a})},"onMouseMove");this.onMouseUp=n(e=>{if(e.preventDefault(),this.isDragging&&this.target){let{clientX:r,clientY:s,screenX:i,screenY:a}=e;this.dispatch("drop",{target:this.target,clientX:r,clientY:s,screenX:i,screenY:a})}window.requestAnimationFrame(()=>this.resetDragging())},"onMouseUp");this.resetDragging=n(()=>{document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove),this.isDragging&&this.target&&this.dragEnd(this.target),this.target&&this.restoreClickEvents(),this.isDragging=!1,this.target=void 0},"resetDragging");document.addEventListener("mousedown",this.onMouseDown),window.addEventListener("blur",this.resetDragging)}};n(Ie,"MouseDragSensor");var Tt=100,j=!1;window.addEventListener("touchmove",t=>{!j||t.preventDefault()},{passive:!1});var De=class extends ${constructor(){super();this.onTouchStart=n(e=>{let{target:r}=e;if(!this.isDraggableElement(r))return;let{clientX:s,clientY:i,screenX:a,screenY:c}=e.touches[0];this.setDragStartPosition(s,i),r.setAttribute("draggable","false"),this.target=r,this.tapTimeout=window.setTimeout(()=>{this.startDragging({target:r,clientX:s,clientY:i,screenX:a,screenY:c})},Tt),window.addEventListener("touchend",this.onTouchEnd),window.addEventListener("touchcancel",this.resetDragging),window.addEventListener("touchmove",this.resetDragging)},"onTouchStart");this.onTouchMove=n(e=>{if(!this.target)return;let{clientX:r,clientY:s,screenX:i,screenY:a}=e.touches[0];this.dispatch("drag",{target:this.target,clientX:r,clientY:s,screenX:i,screenY:a})},"onTouchMove");this.onTouchEnd=n(e=>{if(j&&this.target){let{clientX:s,clientY:i,screenX:a,screenY:c}=e.changedTouches[0];this.dispatch("dragend",{target:this.target,clientX:s,clientY:i,screenX:a,screenY:c})}window.requestAnimationFrame(()=>this.resetDragging())},"onTouchEnd");this.startDragging=n(e=>{!this.shouldDispatchDrag(e.clientX,e.clientY)||(window.removeEventListener("touchmove",this.resetDragging),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),j=!0,this.disableClickEvents(),this.dispatch("dragstart",e))},"startDragging");this.resetDragging=n(()=>{window.removeEventListener("touchend",this.onTouchEnd),window.removeEventListener("touchcancel",this.resetDragging),window.removeEventListener("touchmove",this.resetDragging),window.removeEventListener("touchmove",this.onTouchMove),j&&this.target&&(this.restoreClickEvents(),this.dragEnd(this.target)),this.target=void 0,j=!1,this.tapTimeout!==void 0&&(clearTimeout(this.tapTimeout),this.tapTimeout=void 0)},"resetDragging");window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("blur",this.resetDragging)}};n(De,"TouchDragSensor");var se=class{constructor(e){this.touchSensor=new De,this.mouseSensor=new Ie,Object.assign(this,e)}addListener(e,r){this.mouseSensor.addListener(e,this.selector,r),this.touchSensor.addListener(e,this.selector,r)}removeListener(e,r){this.mouseSensor.removeListener(e,void 0,r),this.touchSensor.removeListener(e,void 0,r)}reset(){Et.forEach(e=>{this.mouseSensor.removeListener(e),this.touchSensor.removeListener(e)})}resetDragging(){this.mouseSensor.resetDragging(),this.touchSensor.resetDragging()}};n(se,"DragSensor");var b,We=n(()=>{b?.reset(),b=new se({selector:".miro-draggable"})},"initDragSensor");var oe="internal:drop",X=new Map,z;async function Ye(t){let e=t.payload;if(e==null)return;let{x:r,y:s}=e,i={x:r,y:s,target:z};X.forEach(a=>a(i)),b.resetDragging()}n(Ye,"handleInternalDrop");async function xt(){h().unsubscribe(oe,Ye),await h().push("UI_UNREGISTER_EVENT",{name:oe})}n(xt,"unsubscribeInternalDrop");async function Ct(){await h().push("UI_REGISTER_EVENT",{name:oe}),h().subscribe(oe,Ye)}n(Ct,"subscribeInternalDropHandler");async function $e(t){let{clientX:e,clientY:r,target:s}=t.detail;z=s;let i=z.dataset.dragPreview,a=parseInt(z.dataset.dragPreviewWidth??"",10),c=parseInt(z.dataset.dragPreviewHeight??"",10);await x("UI_DRAG_START",{clientX:e,clientY:r,dragImage:i?{width:a===Number.NaN?void 0:a,height:c===Number.NaN?void 0:c,src:i}:void 0})}n($e,"onDragStart");var Ae;async function je(t){if(Ae)return;Ae=requestAnimationFrame(()=>{Ae=void 0});let{clientX:e,clientY:r}=t.detail;x("UI_DRAG_MOVE",{clientX:e,clientY:r})}n(je,"onDrag");async function Xe(t){let{clientX:e,clientY:r}=t.detail;await x("UI_DRAG_DROP",{clientX:e,clientY:r})}n(Xe,"onDrop");async function ze(t){await x("UI_DRAG_END")}n(ze,"onDragEnd");function Je(t){X.size==0&&(Ct(),b.addListener("dragstart",$e),b.addListener("drag",je),b.addListener("dragend",ze),b.addListener("drop",Xe)),X.set(t,t)}n(Je,"attachDragAndDropListeners");function Ke(t){X.delete(t),X.size===0&&(b.removeListener("dragstart",$e),b.removeListener("drag",je),b.removeListener("dragend",ze),b.removeListener("drop",Xe),xt())}n(Ke,"detachDragAndDropListeners");async function _t(t){await h().push("UI_REGISTER_EVENT",{name:t})}n(_t,"registerEventListener");async function It(t){await h().push("UI_UNREGISTER_EVENT",{name:t})}n(It,"unregisterEventListener");var Re="icon:click",Me="app_card:open",Oe="app_card:connect",Le="selection:update",Se="online_users:update",ie="items:create",ae="items:delete",me="experimental:items:update",pe="experimental:timer:start",de="experimental:timer:update",ce="experimental:timer:finish",Dt="custom:",Ze=n(t=>t.startsWith(Dt),"isCustomEvent"),ke=class{constructor(){this.listeners={[Re]:[],[Me]:[],[Oe]:[],[Le]:[],[Se]:[],[ie]:[],[me]:[],[ae]:[],[pe]:[],[de]:[],[ce]:[]}}async addListener(e,r){this.listeners[e]||(this.listeners[e]=[]);let s=this.listeners[e];if(s.push(r),s.length===1)return _t(e)}async removeListener(e,r){if(this.listeners[e]=this.listeners[e].filter(s=>s!==r),this.listeners[e].length===0)return It(e)}listen(){Ne(this.listeners).forEach(e=>{h().unsubscribe(e),h().subscribe(e,async r=>{this.listeners[e].forEach(s=>s(r))})})}};n(ke,"AppManager");var le={drop:new Map,"app_card:connect":new Map,"app_card:open":new Map,"icon:click":new Map,"selection:update":new Map,"online_users:update":new Map,[ie]:new Map,[me]:new Map,[ae]:new Map,[pe]:new Map,[de]:new Map,[ce]:new Map};function v(t,e,r){return le[t]||(le[t]=new Map),le[t].set(e,r),r}n(v,"linkExternalToInternalEventHandler");function F(t,e){let r=le[t],s=r.get(e);return r.delete(e),s}n(F,"getInternalEventHandlerFromExternal");var g=new ke;function Qe(t,e){switch(t){case"drop":return Je(v(t,e,e)),Promise.resolve();case Re:return g.addListener(t,v(t,e,async()=>e()));case Me:return g.addListener(t,v(t,e,async r=>{let{appCard:s}=r.payload,i={appCard:f(s)};e(i)}));case Oe:return g.addListener(t,v(t,e,async r=>{let{appCard:s}=r.payload,i={appCard:f(s)};e(i)}));case Le:return g.addListener(t,v(t,e,async r=>{let{items:s}=r.payload,i={items:s.map(a=>f(a))};e(i)}));case Se:return g.addListener(t,v(t,e,async r=>{let s=r.payload;e(s)}));case ie:return g.addListener(t,v(t,e,async r=>{let{items:s}=r.payload,i={items:s.map(a=>f(a))};e(i)}));case me:return g.addListener(t,v(t,e,async r=>{let{items:s}=r.payload,i={items:s.map(a=>f(a))};e(i)}));case ae:return g.addListener(t,v(t,e,async r=>{let{items:s}=r.payload,i={items:s.map(a=>f(a))};e(i)}));case pe:case de:case ce:return g.addListener(t,v(t,e,async r=>{e(r.payload)}));default:if(Ze(t)){let r=n(async s=>{let{items:i}=s.payload,a={items:i.map(c=>f(c))};e(a)},"internalHandler");return h().subscribe(t,r),v(t,e,r),g.addListener(t,r)}throw new Error(`unknown event: ${t}`)}}n(Qe,"on");function et(t,e){switch(t){case"drop":{let r=F(t,e);return r&&Ke(r),Promise.resolve()}case Re:case Me:case Oe:case Le:case Se:case ie:case me:case ae:case pe:case de:case ce:return g.removeListener(t,F(t,e));default:if(Ze(t)){let r=F(t,e);return h().unsubscribe(t,r),g.removeListener(t,r)}throw new Error(`unknown event: ${t}`)}}n(et,"off");var o=Symbol("Commander");var ye=class{constructor(e){this.on=Qe;this.off=et;this[o]=e}async openPanel(e){await this[o].push("UI_OPEN_PANEL",e)}async closePanel(){await this[o].push("UI_CLOSE_PANEL")}async openModal(e){await this[o].push("UI_OPEN_MODAL",e)}async closeModal(){await this[o].push("UI_CLOSE_MODAL")}};n(ye,"BoardUI"),o;var tt;(function(t){t.Red="red",t.Magenta="magenta",t.Violet="violet",t.LightGreen="light_green",t.Green="green",t.DarkGreen="dark_green",t.Cyan="cyan",t.Blue="blue",t.DarkBlue="dark_blue",t.Yellow="yellow",t.Gray="gray",t.Black="black"})(tt||(tt={}));var rt;(function(t){t.Gray="gray",t.LightYellow="light_yellow",t.Yellow="yellow",t.Orange="orange",t.LightGreen="light_green",t.Green="green",t.DarkGreen="dark_green",t.Cyan="cyan",t.LightPink="light_pink",t.Pink="pink",t.Violet="violet",t.Red="red",t.LightBlue="light_blue",t.Blue="blue",t.DarkBlue="dark_blue",t.Black="black"})(rt||(rt={}));var st;(function(t){t.Rectangle="rectangle",t.Circle="circle",t.Triangle="triangle",t.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",t.RoundRectangle="round_rectangle",t.Rhombus="rhombus",t.Parallelogram="parallelogram",t.Star="star",t.RightArrow="right_arrow",t.LeftArrow="left_arrow",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Octagon="octagon",t.Trapezoid="trapezoid",t.FlowChartPredefinedProcess="flow_chart_predefined_process",t.LeftRightArrow="left_right_arrow",t.Cloud="cloud",t.LeftBrace="left_brace",t.RightBrace="right_brace",t.Cross="cross",t.Can="can"})(st||(st={}));var nt;(function(t){t.Rectangle="rectangle",t.Circle="circle",t.Triangle="triangle",t.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",t.RoundRectangle="round_rectangle",t.Rhombus="rhombus",t.Parallelogram="parallelogram",t.Star="star",t.RightArrow="right_arrow",t.LeftArrow="left_arrow",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Octagon="octagon",t.Trapezoid="trapezoid",t.FlowChartPredefinedProcess="flow_chart_predefined_process",t.LeftRightArrow="left_right_arrow",t.Cloud="cloud",t.LeftBrace="left_brace",t.RightBrace="right_brace",t.Cross="cross",t.Can="can",t.FlowChartConnector="flow_chart_connector",t.FlowChartMagneticDisk="flow_chart_magnetic_disk",t.FlowChartInputOutput="flow_chart_input_output",t.FlowChartDecision="flow_chart_decision",t.FlowChartDelay="flow_chart_delay",t.FlowChartDisplay="flow_chart_display",t.FlowChartDocument="flow_chart_document",t.FlowChartMagneticDrum="flow_chart_magnetic_drum",t.FlowChartInternalStorage="flow_chart_internal_storage",t.FlowChartManualInput="flow_chart_manual_input",t.FlowChartManualOperation="flow_chart_manual_operation",t.FlowChartMerge="flow_chart_merge",t.FlowChartMultidocument="flow_chart_multidocument",t.FlowChartNoteCurlyLeft="flow_chart_note_curly_left",t.FlowChartNoteCurlyRight="flow_chart_note_curly_right",t.FlowChartNoteSquare="flow_chart_note_square",t.FlowChartOffpageConnector="flow_chart_offpage_connector",t.FlowChartOr="flow_chart_or",t.FlowChartPredefinedProcess2="flow_chart_predefined_process_2",t.FlowChartPreparation="flow_chart_preparation",t.FlowChartProcess="flow_chart_process",t.FlowChartOnlineStorage="flow_chart_online_storage",t.FlowChartSummingJunction="flow_chart_summing_junction",t.FlowChartTerminator="flow_chart_terminator"})(nt||(nt={}));var J;(function(t){t.Error="error",t.Info="info"})(J||(J={}));var ue=class{constructor(e){this[o]=e}async showInfo(e){let r={message:e,type:J.Info};await this[o].push("SHOW_NOTIFICATION",r)}async showError(e){let r={message:e,type:J.Error};await this[o].push("SHOW_NOTIFICATION",r)}async show(e){await this[o].push("SHOW_NOTIFICATION",e)}};n(ue,"Notifications"),o;var he=class{constructor(e){this[o]=e}async get(){return this[o].push("VIEWPORT_GET")}async set(e){return this[o].push("VIEWPORT_SET",e)}async zoomTo(e){return Array.isArray(e)?this[o].push("VIEWPORT_ZOOM_TO",{items:e.map(r=>r.id)}):this.zoomTo([e])}async getZoom(){return this[o].push("VIEWPORT_GET_ZOOM")}async setZoom(e){return this[o].push("VIEWPORT_SET_ZOOM",{zoomLevel:e})}};n(he,"Viewport"),o;var ot=n((t,e)=>`storage:change:${t}:${e}`,"prefixed"),Be=class{constructor(e,r){this.name=e;this[o]=r}async set(e,r){return this[o].push("STORAGE_SET",{collection:this.name,key:e,value:r})}async get(e){return(await this[o].push("STORAGE_GET",{collection:this.name,key:e})).value}async remove(e){return this[o].push("STORAGE_REMOVE",{collection:this.name,key:e})}async onValue(e,r){let s=await this[o].push("STORAGE_GET",{collection:this.name,key:e});r(s?.value,s?.version);let i=n(async c=>{let{value:w,version:N}=c.payload;return r(w,N)},"internalHandler"),a=ot(this.name,e);return h().subscribe(a,i),v(a,r,i),g.addListener(a,i)}async offValue(e,r){let s=ot(this.name,e),i=F(s,r);return h().unsubscribe(s,i),g.removeListener(s,i)}};n(Be,"Collection"),o;var ge=class{constructor(e){this[o]=e}collection(e){return new Be(e,this[o])}};n(ge,"Storage"),o;async function E(t,e){let r=q(t);return e.push("WIDGET_CREATE",r).then(s=>V(s,t))}n(E,"add");var fe=class{constructor(e,r){this[o]=e,this.ui=new ye(this[o]),this.notifications=new ue(this[o]),this.viewport=new he(this[o]),this.storage=new ge(this[o]),this.experimental=r}async createCard(e){return E(new A(e),this[o])}async createAppCard(e){return E(new R(e),this[o])}async createFrame(e){return E(new M(e),this[o])}async createImage(e){return E(new D(e),this[o])}async createPreview(e){return E(new O(e),this[o])}async createShape(e){return E(new I(e),this[o])}async createStickyNote(e){return E(new _(e),this[o])}async createText(e){return E(new C(e),this[o])}async createEmbed(e){return E(new L(e),this[o])}async createConnector(e){return E(new S(e),this[o])}async createTag(e){return E(new B(e),this[o])}async sync(e){let r=q(e);return this[o].push("WIDGET_UPDATE",r).then(s=>{V(s,e)})}async remove(e){let{id:r,type:s}=e;await this[o].push("WIDGET_REMOVE",{id:r,type:s})}async bringToFront(e){return Array.isArray(e)?this[o].push("BRING_TO_FRONT",{items:e.map(r=>r.id)}):this.bringToFront([e])}async sendToBack(e){return Array.isArray(e)?this[o].push("SEND_TO_BACK",{items:e.map(r=>r.id)}):this.sendToBack([e])}async bringInFrontOf(e,r){return Array.isArray(e)?this[o].push("BRING_IN_FRONT_OF",{items:e.map(s=>s.id),targetId:r.id}):this.bringInFrontOf([e],r)}async sendBehindOf(e,r){return Array.isArray(e)?this[o].push("SEND_BEHIND_OF",{items:e.map(s=>s.id),targetId:r.id}):this.sendBehindOf([e],r)}async getLayerIndex(e){let r=e.id;return this[o].push("GET_LAYER_INDEX",{itemId:r})}async getById(e){let r=await this.get({id:e});if(Array.isArray(r)&&r.length)return f(r[0]);throw new Error(`Can not retrieve item with id ${e}`)}async get(e){let r=await this[o].push("WIDGET_GET",e);if(!Array.isArray(r))throw new Error("Error retrieving items");return r.map(f)}async getInfo(){return this[o].push("GET_BOARD_INFO")}async getUserInfo(){return this[o].push("GET_USER_INFO")}async getSelection(){return(await this[o].push("GET_SELECTION")).map(f)}async getOnlineUsers(){return this[o].push("GET_ONLINE_USERS")}async select(e){return(await this[o].push("SELECT_WIDGETS",e)).map(f)}async deselect(e){return(await this[o].push("DESELECT_WIDGETS",e)).map(f)}async getAppData(e){return this[o].push("GET_BOARD_APP_DATA",{key:e})}async setAppData(e,r){return this[o].push("SET_BOARD_APP_DATA",{key:e,value:r})}async setMetadata(e,r,s){let i=e.id;return this[o].push("WIDGET_SET_METADATA",{itemId:i,key:r,value:s})}async getMetadata(e,r){let s=e.id;return this[o].push("WIDGET_GET_METADATA",{itemId:s,key:r})}async goToLink(e){let r=e.id;return this[o].push("WIDGET_GO_TO_LINK",{itemId:r})}async getIdToken(){return this[o].push("GET_ID_TOKEN")}};n(fe,"Board"),o;var ve=class{constructor(e){this[o]=e}async start(e){let r={duration:e};await this[o].push("TIMER_START",r)}async stop(){return this[o].push("TIMER_STOP")}async pause(){return this[o].push("TIMER_PAUSE")}async resume(){return this[o].push("TIMER_RESUME")}async prolong(e){let r={duration:e};return this[o].push("TIMER_PROLONG",r)}async isStarted(){return this[o].push("TIMER_IS_STARTED")}};n(ve,"Timer"),o;var we=class{constructor(e){this[o]=e}async follow(e,r){let s={followee:e,...r};await this[o].push("ATTENTION_FOLLOW",s)}async isFollowing(){return this[o].push("ATTENTION_IS_FOLLOWING")}async getFollowedUser(){return this[o].push("ATTENTION_GET_FOLLOWED_USER")}async unfollow(){await this[o].push("ATTENTION_UNFOLLOW")}};n(we,"Attention"),o;var be=class{constructor(e){this[o]=e}async register(e){return this[o].push("CUSTOM_ACTION_REGISTER",e)}async deregister(e){await this[o].push("CUSTOM_ACTION_DEREGISTER",e)}};n(be,"CustomActionManagement"),o;var it=n(t=>`experimental:realtime_event:${t}`,"prefixed"),Ee=class{constructor(e){this[o]=e}async broadcast(e,r){await this[o].push("SEND_REALTIME_BROADCAST_EVENT",{event:e,payload:r})}on(e,r){let s=n(async a=>{r(a.payload)},"internalHandler"),i=it(e);return h().subscribe(i,s),v(i,r,s),g.addListener(i,s)}off(e,r){let s=it(e),i=F(s,r);return h().unsubscribe(s,i),g.removeListener(s,i)}};n(Ee,"RealtimeEvents"),o;var Pe=class{constructor(e){this[o]=e,this.attention=new we(e),this.timer=new ve(e),this.action=new be(e),this.events=new Ee(e)}async createMindmapNode(e){let r=await this[o].push("WIDGET_CREATE",new re(e));return new k(r)}async createShape(e){let r=await this[o].push("WIDGET_CREATE",new P(e));return new P(r)}async get(e){let r=await this[o].push("WIDGET_GET",e);if(!Array.isArray(r))throw new Error("Error retrieving items");return r.map(Y)}async select(e){return(await this[o].push("SELECT_WIDGETS",e)).map(Y)}async deselect(e){return(await this[o].push("DESELECT_WIDGETS",e)).map(Y)}async getSelection(){return(await this[o].push("GET_SELECTION")).map(Y)}async getVotingResults(){return this[o].push("GET_VOTING_RESULTS")}async sync(e){let r=q(e);return this[o].push("WIDGET_UPDATE",r).then(s=>{V(s,e)})}async remove(e){let{id:r,type:s}=e;await this[o].push("WIDGET_REMOVE",{id:r,type:s})}async findEmptySpace(e){return this[o].push("FIND_EMPTY_SPACE",e)}};n(Pe,"Experimental"),o;var at="1.53089.0",Te=new U({clientWindow:window}),At=new H(Te,"experimental"),Rt=new Pe(At),mt=new fe(Te,Rt);Ve({commander:Te,board:mt});Te.push("handshake",{clientVersion:at});We();g.listen();new URLSearchParams(location.search).has("autotest")&&console.log("SDKv2 loaded for client version: 1.53089.0 and git commit: 10753a705152e5c1e244a27cd16241c6ba10c6a0");return Mt;})();
